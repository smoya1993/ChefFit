services:
  chef-front:
    build:
      context: ./client
    container_name: chef-front
    restart: unless-stopped
    networks:
      - cicd

  chef-back:
    build:
      context: ./server
    container_name: chef-back
    restart: unless-stopped
    environment:
      - PORT=3000
      # PostgreSQL (preferred: single connection string)
      - DATABASE_URL=${DATABASE_URL}
      # JWT secrets (required)
      - ACCESS_TOKEN_SECRET=${ACCESS_TOKEN_SECRET}
      - REFRESH_TOKEN_SECRET=${REFRESH_TOKEN_SECRET}
      # Client URL (used for Stripe redirect URLs)
      - CLIENT_BASE_URL=${CLIENT_BASE_URL}
      # Stripe (optional)
      - STRIPE_KEY=${STRIPE_KEY}
      - STRIPE_PRICE_ID=${STRIPE_PRICE_ID}
    networks:
      - cicd

networks:
  cicd:
    external: true
